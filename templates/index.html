<!DOCTYPE html>
<html style="height: 100%">
 <head>
  <meta charset="utf-8" />
  <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>
  <script type="text/javascript" src="../static/js/china_map.js"></script>
 </head>
 <body style="height: 100%; margin: 0">
  <div id="header" style="background-color:#FFA500;">
   <h1 style="margin-bottom:0;">Comic Map</h1>
  </div>
  <div id="main" style="background-color:#EEEEEE;height:100%;width:100%;"></div>
  <script type="text/javascript">
    function test(num) {
     var myChart = echarts.init(document.getElementById('main'));
     var chartDom = document.getElementById('main');
     var option;
     if (num == 1) {
         myChart.showLoading();
         $.get('http://192.168.31.11:173/geo_china_json',
         function(chinaJson) {
             myChart.hideLoading();
             echarts.registerMap('China', chinaJson);
             var data = [{
                 name: '北京市',
                 value: 4822023
             },
             {
                 name: '天津市',
                 value: 731449
             },
             {
                 name: '河北省',
                 value: 6553255
             },
             {
                 name: '山西省',
                 value: 2949131
             },
             {
                 name: '内蒙古自治区',
                 value: 38041430
             },
             {
                 name: '辽宁省',
                 value: 5187582
             },
             {
                 name: '吉林省',
                 value: 3590347
             },
             {
                 name: '黑龙江省',
                 value: 917092
             },
             {
                 name: '上海市',
                 value: 632323
             },
             {
                 name: '江苏省',
                 value: 19317568
             },
             {
                 name: '浙江省',
                 value: 9919945
             },
             {
                 name: '安徽省',
                 value: 1392313
             },
             {
                 name: '福建省',
                 value: 1595728
             },
             {
                 name: '江西省',
                 value: 12875255
             },
             {
                 name: '山东省',
                 value: 6537334
             },
             {
                 name: '河南省',
                 value: 3074186
             },
             {
                 name: '湖北省',
                 value: 2885905
             },
             {
                 name: '湖南省',
                 value: 4380415
             },
             {
                 name: '广东省',
                 value: 4601893
             },
             {
                 name: '广西壮族自治区',
                 value: 1329192
             },
             {
                 name: '海南省',
                 value: 5884563
             },
             {
                 name: '重庆市',
                 value: 6646144
             },
             {
                 name: '四川省',
                 value: 9883360
             },
             {
                 name: '贵州省',
                 value: 5379139
             },
             {
                 name: '云南省',
                 value: 2984926
             },
             {
                 name: '西藏自治区',
                 value: 6021988
             },
             {
                 name: '陕西省',
                 value: 1005141
             },
             {
                 name: '甘肃省',
                 value: 1855525
             },
             {
                 name: '青海省',
                 value: 2758931
             },
             {
                 name: '宁夏回族自治区',
                 value: 11544225
             },
             {
                 name: '新疆维吾尔自治区',
                 value: 3814820
             },
             {
                 name: '台湾省',
                 value: 3899353
             },
             {
                 name: '香港特别行政区',
                 value: 12763536
             },
             {
                 name: '澳门特别行政区',
                 value: 6456243
             },
             ];
             data.sort(function(a, b) {
                 return a.value - b.value;
             });
             const mapOption = {
                 visualMap: {
                     left: 'right',
                     min: 500000,
                     max: 38000000,
                     inRange: {
                         // prettier-ignore
                         color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']
                     },
                     text: ['High', 'Low'],
                     calculable: true
                 },
                 series: [{
                     id: 'population',
                     type: 'map',
                     roam: true,
                     map: 'China',
                     animationDurationUpdate: 1000,
                     universalTransition: true,
                     data: data
                 }]
             };
             const barOption = {
                 xAxis: {
                     type: 'value'
                 },
                 yAxis: {
                     type: 'category',
                     axisLabel: {
                         rotate: 30
                     },
                     data: data.map(function(item) {
                         return item.name;
                     })
                 },
                 animationDurationUpdate: 1000,
                 series: {
                     type: 'bar',
                     id: 'population',
                     data: data.map(function(item) {
                         return item.value;
                     }),
                     universalTransition: true
                 }
             };
             let currentOption = mapOption;
             myChart.setOption(mapOption);
             currentOption = currentOption === mapOption ? barOption: mapOption;
             myChart.setOption(currentOption, true);
         });

         option && myChart.setOption(option);
     } else if (num == 2) {
         var myChart = echarts.init(document.getElementById('main'));
         var ROOT_PATH = 'https://cdn.jsdelivr.net/gh/apache/echarts-website@asf-site/examples';

         var chartDom = document.getElementById('main');
         var option;

         myChart.showLoading();
         $.get('http://192.168.31.11:173/geo_china_json',
         function(usaJson) {
             myChart.hideLoading();
             echarts.registerMap('USA', usaJson, {
                 Alaska: {
                     // 把阿拉斯加移到美国主大陆左下方
                     left: -131,
                     top: 25,
                     width: 15
                 },
                 Hawaii: {
                     left: -110,
                     top: 28,
                     width: 5
                 },
                 'Puerto Rico': {
                     // 波多黎各
                     left: -76,
                     top: 26,
                     width: 2
                 }
             });
             option = {
                 title: {
                     text: 'USA Population Estimates (2012)',
                     subtext: 'Data from www.census.gov',
                     sublink: 'http://www.census.gov/popest/data/datasets.html',
                     left: 'right'
                 },
                 tooltip: {
                     trigger: 'item',
                     showDelay: 0,
                     transitionDuration: 0.2,
                     formatter: function(params) {
                         const value = (params.value + '').split('.');
                         const valueStr = value[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g, '$1,');
                         return params.seriesName + '<br/>' + params.name + ': ' + valueStr;
                     }
                 },
                 visualMap: {
                     left: 'right',
                     min: 500000,
                     max: 38000000,
                     inRange: {
                         color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']
                     },
                     text: ['High', 'Low'],
                     calculable: true
                 },
                 toolbox: {
                     show: true,
                     //orient: 'vertical',
                     left: 'left',
                     top: 'top',
                     feature: {
                         dataView: {
                             readOnly: false
                         },
                         restore: {},
                         saveAsImage: {}
                     }
                 },
                 series: [{
                     name: 'USA PopEstimates',
                     type: 'map',
                     roam: true,
                     map: 'USA',
                     emphasis: {
                         label: {
                             show: true
                         }
                     },
                     data: [{
                         name: '北京市',
                         value: 4822023
                     },
                     {
                         name: '天津市',
                         value: 731449
                     },
                     {
                         name: '河北省',
                         value: 6553255
                     },
                     {
                         name: '山西省',
                         value: 2949131
                     },
                     {
                         name: '内蒙古自治区',
                         value: 38041430
                     },
                     {
                         name: '辽宁省',
                         value: 5187582
                     },
                     {
                         name: '吉林省',
                         value: 3590347
                     },
                     {
                         name: '黑龙江省',
                         value: 917092
                     },
                     {
                         name: '上海市 of Columbia',
                         value: 632323
                     },
                     {
                         name: '江苏省',
                         value: 19317568
                     },
                     {
                         name: '浙江省',
                         value: 9919945
                     },
                     {
                         name: '安徽省',
                         value: 1392313
                     },
                     {
                         name: '福建省',
                         value: 1595728
                     },
                     {
                         name: '江西省',
                         value: 12875255
                     },
                     {
                         name: '山东省',
                         value: 6537334
                     },
                     {
                         name: '河南省',
                         value: 3074186
                     },
                     {
                         name: '湖北省',
                         value: 2885905
                     },
                     {
                         name: '湖南省',
                         value: 4380415
                     },
                     {
                         name: '广东省',
                         value: 4601893
                     },
                     {
                         name: '广西壮族自治区',
                         value: 1329192
                     },
                     {
                         name: '海南省',
                         value: 5884563
                     },
                     {
                         name: '重庆市',
                         value: 6646144
                     },
                     {
                         name: '四川省',
                         value: 9883360
                     },
                     {
                         name: '贵州省',
                         value: 5379139
                     },
                     {
                         name: '云南省',
                         value: 2984926
                     },
                     {
                         name: '西藏自治区',
                         value: 6021988
                     },
                     {
                         name: '陕西省',
                         value: 1005141
                     },
                     {
                         name: '甘肃省',
                         value: 1855525
                     },
                     {
                         name: '青海省',
                         value: 2758931
                     },
                     {
                         name: '宁夏回族自治区',
                         value: 11544225
                     },
                     {
                         name: '新疆维吾尔自治区',
                         value: 3814820
                     },
                     {
                         name: '台湾省',
                         value: 3899353
                     },
                     {
                         name: '香港特别行政区',
                         value: 12763536
                     },
                     {
                         name: '澳门特别行政区',
                         value: 6456243
                     },
                     ]
                 }]
             };
             myChart.setOption(option);
         });
         let currentOption = barOption;
         myChart.setOption(currentOption, true);
         currentOption = currentOption === mapOption ? mapOption: barOption;
         option && myChart.setOption(option);
     }
 }
  </script>
  <div id="footer" style="background-color:#FFA500;clear:both;text-align:center;">
   <input type="button" onclick="test(1)" value="点击1" />
   <input type="button" onclick="test(2)" value="点击2" />
  </div>
 </body>
</html>
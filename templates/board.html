<!DOCTYPE html>

<html style="height: 100%">
    <head>
        <meta charset="utf-8">
        <script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>
        <script type="text/javascript" src="../static/js/china_map.js"></script>
<!--        <script type="text/javascript" src="../static/js/echarts_map.js"></script>-->
    </head>
    <body style="height: 100%; margin: 0">
        <div id="main" style="height: 100%"></div>
        <script type="text/javascript">
            var myChart = echarts.init(document.getElementById('main'));
            var option = {
                backgroundColor: '#000',
                title: {
                    text: 'ComicMap',
                    left: 'center',
                    textStyle: {
                        color: '#fff'
                    }
                },
                geo: {
                    map: 'china',
                    roam: true,
                    label: {
                        emphasis: {
                            show: false
                        }
                    },
                    silent: true,
                    itemStyle: {
                        normal: {
                            areaColor: '#323c48',
                            borderColor: '#111'
                        },
                    emphasis: {
                        areaColor: '#2a333d'
                        }
                    }
                },
                series: [{
                    name: 'å¼±',
                    type: 'scatterGL',
                    progressive: 1e6,
                    coordinateSystem: 'geo',
                    symbolSize: 1,
                    zoomScale: 0.002,
                    blendMode: 'lighter',
                    large: true,
                    itemStyle: {
                        color: 'rgb(20, 15, 2)'
                    },
                    postEffect: {
                        enable: true
                    },
                    silent: true,
                    dimensions: ['lng', 'lat'],
                    data: new Float32Array()
                    }
                ]
            };
            myChart.setOption(option);
            var httpRequest = new XMLHttpRequest();
            httpRequest.open('GET', 'http://192.168.31.11:173/get_json', true);
            httpRequest.send();
            httpRequest.onreadystatechange = function () {
                if (httpRequest.readyState == 4 && httpRequest.status == 200) {
                    var json = eval("("+httpRequest.responseText+")");
<!--                    console.log(json);-->
                    myChart.appendData({
                        seriesIndex: 0,
                        data: json['gps']
                    });
                }
            };

<!--            var data = new Float32Array(4);-->
<!--            var obj = eval('({{result_json|safe }})');-->
<!--            data = obj['a'];-->


        </script>
    </body>
</html>
